{{ if isset .Params "series" }}
  {{ $seriesName := index .Params.series 0 }}
  {{ $related := where .Site.RegularPages "Params.series" "intersect" (slice $seriesName) }}
  <section class="series-posts" aria-label="Posts in this series">
    <h2>Posts in this series</h2>
    <ul class="series-posts-list" style="list-style:none; padding-left:0; margin:0; display:grid; gap:1rem; grid-template-columns:repeat(auto-fill,minmax(240px,1fr));">
      {{ range sort $related "Date" }}
        <li style="border:1px solid #eee; border-radius:8px; background:#fff; overflow:hidden; box-shadow:0 2px 6px rgba(0,0,0,0.05); padding:0;">
          <a href="{{ .RelPermalink }}" title="{{ .Title }}" style="text-decoration:none; color:inherit; display:block;">
            {{ with .Params.thumbnail }}<img src="/{{ . }}" alt="" loading="lazy" style="width:100%; height:140px; object-fit:cover; display:block; margin:0;" />{{ end }}
            <div style="padding:.75rem .85rem 1rem .85rem;">
              <div style="font-weight:600; font-size:1rem; line-height:1.3; margin-bottom:.45rem; display:-webkit-box; -webkit-line-clamp:2; line-clamp:2; -webkit-box-orient:vertical; overflow:hidden; text-overflow:ellipsis; min-height:2.6em;" title="{{ .Title }}">{{ .Title }}</div>
              <div style="font-size:.8rem; color:#777; display:flex; gap:.6rem; flex-wrap:wrap;">
                <span>{{ .Date.Format "Jan 2, 2006" }}</span>
                {{ with .Params.tags }}
                  {{ $limited := (first 2 .) }}
                  <span>{{ delimit $limited ", " }}</span>
                {{ end }}
              </div>
            </div>
          </a>
        </li>
      {{ end }}
    </ul>
  </section>
{{ end }}
