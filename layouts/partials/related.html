{{ if isset .Params "series" }}
  {{ $seriesName := index .Params.series 0 }}
  {{ $related := where .Site.RegularPages "Params.series" "intersect" (slice $seriesName) }}
  <h2 class="post_related">Posts in this series</h2>
  <div class="series-posts-grid" style="display: flex; flex-wrap: wrap; gap: 2rem; justify-content: flex-start;">
    {{ range sort $related "Date" }}
      <div class="series-post-card" style="border-radius: 12px; background: #fff; box-shadow: 0 2px 8px rgba(0,0,0,0.06); width: calc(33% - 1.5rem); min-width: 300px; max-width: 400px; margin-bottom: 2rem; overflow: hidden;">
  <a href="{{ .Permalink }}" title="{{ .Title }}" aria-label="{{ .Title }}" data-full-title="{{ .Title }}" style="text-decoration: none; color: inherit; display: block;">
          <div style="position: relative;">
            {{ with .Params.thumbnail }}
              <img src="/{{ . }}" style="width: 100%; height: 200px; object-fit: cover; display: block;" />
            {{ end }}
            {{ with .Params.duration }}
              <span style="position: absolute; bottom: 10px; right: 10px; background: rgba(0,0,0,0.7); color: #fff; font-size: 0.95rem; padding: 2px 8px; border-radius: 4px;">{{ . }}</span>
            {{ end }}
          </div>
          <div style="padding: 0.2rem 1rem 0.7rem 1rem;">
            <div title="{{ .Title }}" aria-label="{{ .Title }}" style="font-size: 1.15rem; font-weight: 600; margin-bottom: 0.6rem; line-height: 1.3; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; text-overflow: ellipsis; min-height: calc(1.3em * 2); line-clamp: 2;">{{ .Title }}</div>
            <div style="display: flex; align-items: center; font-size: 0.98rem; color: #888; margin-bottom: 0.5rem; gap: 1.2rem;">
              <span>{{ .PublishDate.Format "Jan 2, 2006" }}</span>
            </div>
          </div>
        </a>
      </div>
    {{ end }}
  </div>
{{ end }}
